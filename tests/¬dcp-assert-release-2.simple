#! /usr/bin/env node
/**
 * @file        dcp-assert-release-2.js
 *              dcp-assert tests for release-mode builds; ensures that the
 *              fast path is present in a release build.
 *
 * @author      Wes Garland, wes@kingsds.network
 * @date        July 2022
 */

async function main()
{
  const assertLib = require('dcp/dcp-assert');

  switch (dcpConfig.build)
  {
    default:
      console.error('Unknown dcpConfig.build:', dcpConfig.build);
      return;
      
    case 'release':
      assertLib.always.assertEq3(true,true); /* make sure internals ready to skip fast path */
      assertLib.always.assertEq3(assertLib.assert, assertLib.always.assert);
      break;

    case 'debug':
      assertLib.assertEq3(true, false);
      break;
  }

  console.log('test completed, dcpConfig.build=', dcpConfig.build);
}

require('./setup-testenv');
require('..').init().then(main).catch(err => process.exitCode = 2);
