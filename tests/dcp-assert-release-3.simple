#! /usr/bin/env node
/**
 * @file        dcp-assert-release-3.js
 *              dcp-assert tests for release-mode builds; ensures that the
 *              fast path does nothing in a release build.
 *
 * @author      Wes Garland, wes@kingsds.network
 * @date        July 2022
 */

async function main()
{
  const assertLib = require('dcp/dcp-assert');

  switch (dcpConfig.build)
  {
    default:
      console.error('Unknown dcpConfig.build:', dcpConfig.build);
      return;
      
    case 'release':
      assertLib.assertEq3(true, true);  /* warm up assertLib to ensure no false-fire */
      assertLib.assertEq3(true, false); /* fast path shouldn't (non-false) fire */
      break;

    case 'debug':
      console.log('this test does nothing in a debug build');
      break;
  }

  console.log('test passed, dcpConfig.build =', dcpConfig.build);
}

require('./setup-testenv');
require('..').init().then(main).catch(err => {
  process.exitCode = 2;
  console.error(err);
});
