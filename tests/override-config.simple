#! /usr/bin/env node
/**
 * @file        override-config.simple
 *              Test which ensures that custom config files (options.configName)
 *              are overridden by /etc/dcp/override-dcp-config.js
 * @date        Sep 2022
 */
'use strict';
require('./setup-testenv');
const dcpClient = require('..');

async function main()
{
  const dcpConfig = require('dcp/dcp-config');

  if (dcpConfig.stack['./etc/dcp-config.js'] !== 'yes')
    throw new Error('./etc/dcp-config.js was either not loaded, or was overridden incorrectly');
  if (dcpConfig.stack['/etc/dcp/override-dcp-config.js'] !== 'yes')
    throw new Error('test-pseudo-root/etc/override-dcp-config.js was not loaded');
}

dcpClient.init({/*dcpConfig*/}, {
  configName:  './etc/dcp-config',
  configScope: 'config-simple-test',
}).then(main).catch(console.error);
