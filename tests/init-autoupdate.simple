/**
 * Note: this test assumes that the local DCP-client and the production
 * DCP-client bundle were built at different times.  If this test is run from
 * the same bootstrap bundle as the published bundle, it will fail, because it
 * can't detect the update.
 */

const process = require('process');
const dcpClient = require('..');
const { assertNeq3 } = require('dcp/dcp-assert').always;
require('./setup-testenv');

process.env.DCP_CONFIG_LOCATION =
  'https://scheduler.distributed.computer/etc/dcp-config.js';

async function main() {
  await dcpClient.init(undefined, true);

  assertNeq3(require('dcp/build'), require('dcp/bootstrap-build'));
  assertNeq3(require('dcp/build').built, require('dcp/bootstrap-build').built);
}

main()
  .then(() => process.exit(0))
  .catch((e) => console.error(e) && process.exit(1));
