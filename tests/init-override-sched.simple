#! /usr/bin/env node
/**
 * @file        init-override-sched.simple
 *              Test that overriding the scheduler location in dcp-client ini
 *              affects dcpConfig.
 *
 * @author      Wes Garland, wes@kingsds.network
 * @date        Aug 2020
 */
'use strict';

process.env.DCP_CONFIG_LOCATION=''

const dcpClient = require('..');
const assert = require('assert');
const alternateScheduler = 'ftp://anvil.acme.com/';

dcpClient.init(alternateScheduler).then(() => {
  const scheduler = require('dcp/dcp-config').scheduler;
  console.log('scheduler location is:', scheduler.location.href);

  assert.equal(dcpConfig.scheduler.location.href, alternateScheduler, 'dcpClient::init() did not change scheduler location properly)');
  assert.equal(dcpConfig.scheduler, scheduler, 'dcpConfig is badly broken');
});
